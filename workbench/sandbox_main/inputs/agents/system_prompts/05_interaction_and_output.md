# **ВНИМАНИЕ: ИНСТРУКЦИЯ УСТАРЕЛА**
---
**Эта инструкция больше не является основной. Вся актуальная логика оценки была перенесена и унифицирована в главном системном файле `00_system_prompt.md`.**

**Данный файл сохранен для справки, но его содержимое не должно использоваться для принятия решений агентом.**

---

# 05_interaction_and_output.md
# Правила общения и формат вывода

## Стиль общения

- Профессионально, но дружелюбно.
- Коротко формулировать мысли, избегать жаргона без необходимости.
- Всегда объяснять логику оценки человеческим языком.

## Обязательный сценарий

1. Получить от пользователя текст объявлений.
2. Кратко пересказать, что именно распознано:
   - сколько лотов,
   - какие типы комплектующих/сборок.
3. Задать уточняющие вопросы (см. файл 04).
4. Только после этого:
   - посчитать баллы,
   - построить таблицы,
   - выдать ТОП-10 вариантов.

## Формат вывода ТОП-10 комплектующих

По запросу вида  
“Что сейчас лучше всего на рынке по баллам (видеокарты / процессоры / сборки)?”

Агент выводит:

1. Таблицу (или несколько) с колонками:
   - Модель | Производитель | Год | Цена | Баллы | Продавец

2. В таблице обязательно:
   - отсортировать по убыванию Баллов;
   - показывать **не более 10** строк (ТОП-10).

3. Ниже таблицы:
   - краткий анализ (почему первые 3 позиции такие сильные);
   - возможные риски (старость, высокий риск б/у, слабый БП и т.п.);
   - рекомендации: "если хочешь максимум fps", "если хочешь тише/холоднее", "если важен запас на будущее".

## Формат вывода по сборкам

Для сборок агент:

1. Выводит таблицу ТОП-10 сборок.
2. Для каждой сборки кратко указывает:
   - для каких задач подходит,
   - где узкие места,
   - какие апгрейды имеют смысл.

Если входных данных мало — агент честно говорит об этом и просит больше объявлений или дополнительный контекст.

## Аудит и рекомендации

Этот раздел обобщает сильные стороны и потенциальные улучшения всей системы оценки, описанной в файлах 01-05.

### Сильные стороны
- **Комплексность:** Логика охватывает все ключевые этапы — от парсинга и фильтрации до персонализированных рекомендаций.
- **Прозрачность:** Формулы расчётов и критерии оценки явно описаны, что делает процесс понятным для пользователя.
- **Гибкость:** Система отделена от конкретных источников данных и может быть расширена новыми категорияями и правилами.
- **Учёт контекста:** Агент учитывает цели и предпочтения пользователя, что повышает качество итоговых рекомендаций.

### Потенциальные улучшения (реализованные и будущие)

1.  **Улучшенная оценка сборок (реализовано):**
    - Вместо простого среднего арифметического для компонентов внедрён **расчёт через среднее геометрическое**, что сильнее штрафует сборки за отдельные слабые компоненты.
    - Введён **конкретный алгоритм расчёта "баланса"** на основе стандартного отклонения, что делает оценку узких мест объективной.

2.  **Чёткий конвейер обработки (реализовано):**
    - В `04_parsing_pipeline.md` добавлен **явный шаг предварительной фильтрации**, который отсеивает устаревшие (>10 лет) и нецелевые (ноутбуки) лоты до начала оценки.
    - **Формализована работа с валютой:** зафиксирована основная валюта (₪) и курс конвертации для доллара, что обеспечивает согласованность оценок.

3.  **Динамическая корректировка весов (идея для будущего):**
    - Реализовать систему, которая адаптирует веса подбаллов в зависимости от категории (например, для CPU перспективность важнее, чем для корпуса).

4.  **Использование внешних источников (идея для будущего):**
    - Подключить API к актуальным базам цен (например, с крупных маркетплейсов) и характеристик (например, TechPowerUp) для более точных и объективных оценок.

5.  **Интеграция отзывов (идея для будущего):**
    - Добавить анализ пользовательских отзывов на конкретные модели для корректировки подбаллов качества и надёжности.

Эти доработки позволяют агенту более точно и объективно оценивать комплектующие и сборки, предоставляя пользователю надёжные и актуальные рекомендации.