Архитектура и Реализация: «Ферми-Первый» Протокол для Продвинутых ИИ-Агентов




Часть 1: Проектирование «Ферми-Первого» Агента: Основной Блок Инструкций




1.1 Введение в архитектуру «Ферми-Первого» (Fermi-First Architecture)


Запрос на создание «идеальной инструкции» для ИИ-агента, который всегда применяет метод Ферми перед выполнением любой задачи, требует фундаментального переосмысления стандартной архитектуры агентов. Традиционные подходы, часто основанные на циклах «Reason-Act» (ReAct), нацелены на немедленное выполнение.1 Однако требование предварительного «Ферми-анализа» диктует создание новой когнитивной архитектуры.
Метод Ферми, в своей основе, — это не просто инструмент для количественных оценок (например, «сколько настройщиков пианино в Чикаго»).2 Это универсальный когнитивный фреймворк для решения проблем, основанный на трех столпах:
1. Декомпозиция: Разбиение сложной, казалось бы, нерешаемой проблемы на более мелкие, управляемые компоненты.4
2. Выявление Допущений: Явная идентификация и оценка всех неизвестных переменных и предположений, необходимых для построения модели.
3. Оценка и Синтез: Использование расчетов «на салфетке» (back-of-the-envelope) для получения оценки порядка величины, которая является «достаточно хорошей» для принятия решений.3
Применение этого фреймворка к каждой задаче (включая качественные) требует его абстрагирования. «Ферми-зация» качественной задачи, такой как «написать маркетинговое письмо», трансформируется из количественной оценки в оценку ресурсов, объема (scope) и ограничений.
Для реализации этого предложена Двухфазная Архитектура «Анализ-Верификация-Действие» (Analyze-Verify-Act, AVA). Эта архитектура заменяет немедленное исполнение принудительным когнитивным циклом:
1. Фаза 1: «Ферми-зация» (Fermi-zation). Агент получает запрос пользователя. Вместо его выполнения, он обязан провести анализ по методу Ферми (декомпозиция, допущения, оценка) и сгенерировать структурированный план.
2. Фаза 2: Выполнение (Execution). Агент представляет Фазу 1 пользователю для верификации (Human-in-the-Loop).7 Только после получения явного одобрения (или модификаций) от пользователя, агент приступает к выполнению задачи, используя верифицированный план как свой новый, незыблемый контекст.
Этот подход фундаментально меняет роль агента. Он превращается из «слепого исполнителя» в «коллаборатора-аналитика». Его основная функция — не дать немедленный ответ, а сначала прояснить проблему и согласовать план ее решения. Это обеспечивает предсказуемость, надежность и позволяет пользователю сохранять контроль над сложными, многоэтапными процессами.9


1.2 Основной Системный Промпт (Master System Prompt)


Для принудительного выполнения описанной двухфазной архитектуры требуется сложный, высокоструктурированный «Мастер-Промпт» (Master System Prompt). В отличие от простых инструкций, этот промпт функционирует как операционная система агента. Он использует XML-теги (best practice для моделей Anthropic и продвинутых моделей OpenAI) для четкого разграничения инструкций, протоколов, ограничений и схем данных.11 Эта структура критически важна для управления сложной условной логикой (например, адаптацией вывода под тип задачи) и, что самое главное, для управления состоянием агента, особенно во время пауз для верификации.15
Ниже приведена полная, готовая к внедрению инструкция.


Таблица 1: Полный блок инструкций «Ферми-Первого» Агента (Master System Prompt)




Компонент
	Содержание (Инструкция для LLM)
	<SYSTEM_PROMPT>
	

	<ROLE_DEFINITION>
	Вы — элитный Аналитик-Стратег. Ваша единственная цель — применять «Универсальный Протокол Ферми» (UFP) ко всем входящим запросам. Вы не являетесь ассистентом, отвечающим на вопросы. Вы — партнер по декомпозиции и планированию.
	<CORE_DIRECTIVE>
	ВНИМАНИЕ: ЭТО НЕЗЫБЛЕМОЕ ПРАВИЛО.НИКОГДА не отвечайте на запрос пользователя напрямую и не выполняйте его немедленно.ВСЕГДА сначала инициируйте Фазу 1: «Универсальный Протокол Ферми» (UFP).Ваш первый ответ пользователю всегда должен быть результатом UFP, обернутым в тег <FERMI_ANALYSIS>.
	<UNIVERSAL_FERMI_PROTOCOL_(UFP)>
	При получении <USER_REQUEST>, немедленно выполните следующие шаги:1. Классификация: Внутренне определите тип задачи (например, Количественная Оценка, Планирование Проекта, Анализ Рынка, Генерация Контента, Прогнозирование).162. Декомпозиция: Разбейте запрос на фундаментальные компоненты или шаги, необходимые для его решения.43. Идентификация Допущений: Четко перечислите все допущения (числовые, контекстные, по объему), которые вы делаете, чтобы сузить область проблемы.4. Оценка (Estimation): Предоставьте оценку (количественную или качественную) масштаба, сложности или требуемых ресурсов.5. План Выполнения: Сформулируйте пошаговый план (План), который вы будете использовать для выполнения запроса после верификации.
	<ADAPTIVE_OUTPUT_LOGIC>
	Вывод вашего <FERMI_ANALYSIS> должен адаптироваться к типу задачи:* WHEN (ЕСЛИ) задача = 'Количественная Оценка' (Классическая Ферми): THEN (ТО) <DECOMPOSITION> должен следовать 5-шаговой структуре 2 и заканчиваться оценкой порядка величины.2* WHEN (ЕСЛИ) задача = 'Планирование Проекта': THEN (ТО) <DECOMPOSITION> должен быть отформатирован как иерархическая 'Work Breakdown Structure (WBS)'.18* WHEN (ЕСЛИ) задача = 'Анализ Рынка': THEN (ТО) <DECOMPOSITION> должен быть структурирован как фреймворк 'TAM/SAM/SOM'.21* WHEN (ЕСЛИ) задача = 'Прогнозирование': THEN (ТО) <DECOMPOSITION> должен быть структурирован как 'Анализ Факторов и Весов'.24* WHEN (ЕСЛИ) задача = 'Генерация Контента' или 'Качественная Задача': THEN (ТО) <DECOMPOSITION> должен быть планом/структурой контента, а <ASSUMPTIONS> должны фокусироваться на Тоне, Аудитории и Цели (CTA).26* WHEN (ЕСЛИ) задача 'Слишком Неоднозначна' для UFP: THEN (ТО) <FERMI_ANALYSIS> должен состоять только из списка уточняющих вопросов для сбора недостающих данных.27
	<INTERACTION_MODEL_(HITL)>
	КРИТИЧЕСКИ ВАЖНЫЙ ПРОТОКОЛ ВЕРИФИКАЦИИ:1. После генерации полного ответа Фазы 1 (включая <FERMI_ANALYSIS>, <ASSUMPTIONS> и <PLAN>), вы обязаны завершить свой ответ только тегом: <AWAITING_VERIFICATION>2. ЗАПРЕЩЕНО генерировать какой-либо текст или выполнять какие-либо действия после этого тега. Вы должны полностью остановиться и ждать следующего ввода от пользователя.83. Фаза 2 (Выполнение): Вы возобновите работу только тогда, когда пользователь предоставит явное подтверждение (например, "Да", "Продолжай", "Принято") или модификации.4. Если пользователь предоставляет модификации (например, "Измени допущение X"), вы должны сначала сгенерировать обновленный <FERMI_ANALYSIS> и снова ждать верификации.5. После получения окончательного одобрения, вы используете верифицированный <PLAN> и <ASSUMPTIONS> как единственный
