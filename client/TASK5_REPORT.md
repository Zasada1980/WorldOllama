# ๐ TASK 5: SETTINGS + AGENT PROFILES - ะะขะงะะข ะ ะะซะะะะะะะะ

**ะะฐัะฐ:** 27 ะฝะพัะฑัั 2025 ะณ.  
**ะกัะฐััั:** โ **ะะะะะะจะะะ ะะ 100%**  
**ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั:** ~2 ัะฐัะฐ (ะฒัะต ะฟะพะดะทะฐะดะฐัะธ)

---

## ๐ฏ ะฆะตะปั ะทะฐะดะฐัะธ

ะกะพะทะดะฐัั ะฟะพะปะฝะพััะฝะบัะธะพะฝะฐะปัะฝัะน ะธะฝัะตััะตะนั ะฝะฐัััะพะตะบ ั:
- ะะพะบะฐะปัะฝัะผ ััะฐะฝะตะฝะธะตะผ ะฒ `AppData`
- ะะฝัะตะณัะฐัะธะตะน ั Core Bridge ะบะพะผะฐะฝะดะฐะผะธ
- ะัะฑะพัะพะผ ะผะพะดะตะปะธ LLM, ะฟะฐัะฐะผะตััะพะฒ CORTEX ะธ ะฟัะพัะธะปะตะน ะฐะณะตะฝัะฐ
- ะะตััะธััะตะฝัะฝะพัััั ะฝะฐัััะพะตะบ ะผะตะถะดั ะฟะตัะตะทะฐะฟััะบะฐะผะธ

---

## โ ะัะฟะพะปะฝะตะฝะฝัะต ะฟะพะดะทะฐะดะฐัะธ

### Task 5.2: Backend ะดะปั ะฝะฐัััะพะตะบ (Rust)

#### 5.2.1: AppSettings ััััะบัััะฐ โ

**ะคะฐะนะป:** `client/src-tauri/src/settings.rs` (95 ัััะพะบ)

**ะกัััะบัััะฐ ะดะฐะฝะฝัั:**
```rust
pub struct AppSettings {
    pub ollama_model: String,           // ะะพะดะตะปั LLM (default: "qwen2.5:14b-instruct-q4_k_m")
    pub max_tokens: Option<u32>,        // ะะธะผะธั ัะพะบะตะฝะพะฒ (optional)
    pub cortex_top_k: u32,              // Top-K ะดะพะบัะผะตะฝัะพะฒ (default: 20)
    pub cortex_mode: String,            // ะะตะถะธะผ ะฟะพะธัะบะฐ (default: "local")
    pub active_agent_profile: String,   // ะะบัะธะฒะฝัะน ะฟัะพัะธะปั (default: "triz_engineer")
}
```

**ะัะฝะพะฒะฝัะต ััะฝะบัะธะธ:**
- `get_settings_path()` โ ะบัะพัั-ะฟะปะฐััะพัะผะตะฝะฝัะน ะฟััั ะบ ัะฐะนะปั ะฝะฐัััะพะตะบ
  - Windows: `%APPDATA%\tauri_fresh\settings.json`
  - Linux: `~/.config/tauri_fresh/settings.json`
  - macOS: `~/Library/Application Support/tauri_fresh/settings.json`
- `load_settings()` โ ะทะฐะณััะทะบะฐ ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผ fallback ะฝะฐ Default ะฟัะธ ะพัะธะฑะบะฐั
- `save_settings(&AppSettings)` โ ัะพััะฐะฝะตะฝะธะต ะฒ pretty-printed JSON

**ะะพะฑะฐะฒะปะตะฝะฝัะต ะทะฐะฒะธัะธะผะพััะธ:**
```toml
dirs = "5.0"  # ะัะพัั-ะฟะปะฐััะพัะผะตะฝะฝัะต ะฟััะธ ะบ ะดะธัะตะบัะพัะธัะผ
```

**ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ:**
- ะััััััะฒัะตั ัะฐะนะป โ ะฒะพะทะฒัะฐั Default ะทะฝะฐัะตะฝะธะน
- ะัะธะฑะบะฐ ะฟะฐััะธะฝะณะฐ JSON โ ะฒะพะทะฒัะฐั Default ะทะฝะฐัะตะฝะธะน
- ะัะธะฑะบะฐ ะทะฐะฟะธัะธ โ Result<(), String> ั ะพะฟะธัะฐะฝะธะตะผ ะพัะธะฑะบะธ
- ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต ะดะธัะตะบัะพัะธะธ ะฟัะธ ะฟะตัะฒะพะผ ัะพััะฐะฝะตะฝะธะธ

---

#### 5.2.2: Tauri ะบะพะผะฐะฝะดั โ

**ะคะฐะนะป:** `client/src-tauri/src/commands.rs` (ะดะพะฑะฐะฒะปะตะฝะพ 20+ ัััะพะบ)

**ะะพะฒัะต ะบะพะผะฐะฝะดั:**

```rust
#[tauri::command]
pub async fn get_app_settings() -> ApiResponse<AppSettings> {
    let settings = load_settings();
    ApiResponse::success(settings)
}

#[tauri::command]
pub async fn save_app_settings(settings: AppSettings) -> ApiResponse<AppSettings> {
    match save_settings(&settings) {
        Ok(_) => ApiResponse::success(settings),
        Err(e) => ApiResponse::error("settings_save_error", e),
    }
}
```

**ะะตะณะธัััะฐัะธั ะฒ `lib.rs`:**
```rust
mod settings;
use commands::{..., get_app_settings, save_app_settings};

.invoke_handler(tauri::generate_handler![
    greet,
    get_system_status,
    send_ollama_chat,
    send_cortex_query,
    get_app_settings,    // NEW
    save_app_settings,   // NEW
])
```

**ะัะพะฒะตัะบะฐ ะบะพะผะฟะธะปััะธะธ:**
```bash
cargo check
# โ Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.76s
```

---

### Task 5.3: ะะฝัะตะณัะฐัะธั Core Bridge ั ะฝะฐัััะพะนะบะฐะผะธ โ

**ะะพะดะธัะธัะธัะพะฒะฐะฝะฝัะต ะบะพะผะฐะฝะดั:**

#### 5.3.1: `send_ollama_chat` โ ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะผะพะดะตะปะธ ะธะท ะฝะฐัััะพะตะบ

**ะะพ:**
```rust
let model = model.unwrap_or_else(|| "qwen2.5:14b-instruct-q4_k_m".to_string());
```

**ะะพัะปะต:**
```rust
let settings = load_settings();
// ะัะธะพัะธัะตั: ะฟะฐัะฐะผะตัั ะธะท UI -> ะฝะฐัััะพะนะบะธ -> default
let model = model.unwrap_or(settings.ollama_model);
```

**ะญััะตะบั:**
- ะัะปะธ ััะพะฝัะตะฝะด ะฟะตัะตะดะฐัั `model: null` โ ะธัะฟะพะปัะทัะตััั `settings.ollama_model`
- ะัะปะธ ััะพะฝัะตะฝะด ะฟะตัะตะดะฐัั ะบะพะฝะบัะตัะฝัั ะผะพะดะตะปั โ ะพะฝะฐ ะธะผะตะตั ะฟัะธะพัะธัะตั
- Fallback: `qwen2.5:14b-instruct-q4_k_m` (ะธะท Default impl)

---

#### 5.3.2: `send_cortex_query` โ ะัะฟะพะปัะทะพะฒะฐะฝะธะต top_k ะธ mode ะธะท ะฝะฐัััะพะตะบ

**ะะพ:**
```rust
// ะฅะฐัะดะบะพะด ะทะฝะฐัะตะฝะธะน
let request_body = CortexRequest {
    query,
    top_k: Some(20),
    mode: Some("local".to_string()),
};
```

**ะะพัะปะต:**
```rust
let settings = load_settings();
let effective_top_k = top_k.unwrap_or(settings.cortex_top_k);
let effective_mode = mode.unwrap_or(settings.cortex_mode);

let request_body = CortexRequest {
    query,
    top_k: Some(effective_top_k),
    mode: Some(effective_mode),
};
```

**ะะพะณะธะบะฐ ะฟัะธะพัะธัะตัะพะฒ:**
1. ะฏะฒะฝัะต ะฟะฐัะฐะผะตััั ะธะท UI (`topK`, `mode`) โ ะฝะฐะธะฒัััะธะน ะฟัะธะพัะธัะตั
2. ะะฝะฐัะตะฝะธั ะธะท ะฝะฐัััะพะตะบ (`settings.cortex_top_k`, `settings.cortex_mode`)
3. Default ะทะฝะฐัะตะฝะธั ะธะท `impl Default for AppSettings`

---

### Task 5.4 & 5.5: SettingsPanel.svelte โ UI ะบะพะผะฟะพะฝะตะฝั โ

**ะคะฐะนะป:** `client/src/lib/components/SettingsPanel.svelte` (380+ ัััะพะบ)

**ะัะฝะพะฒะฝัะต ัะตะบัะธะธ:**

#### ๐ค ะกะตะบัะธั 1: ะะพะดะตะปั LLM (Ollama)

**ะญะปะตะผะตะฝัั:**
- `<select>` ั ะดะพัััะฟะฝัะผะธ ะผะพะดะตะปัะผะธ:
  - `qwen2.5:14b-instruct-q4_k_m` (default)
  - `qwen2.5:3b-instruct`
  - `triz-td010v2:latest`
  - `llama3.1:8b`
  - `librarian-lite`
- `<input type="number">` ะดะปั `max_tokens` (ะพะฟัะธะพะฝะฐะปัะฝะพ, 100-4096)
- ะะพะดัะบะฐะทะบะธ ะฟะพ ะบะฐะถะดะพะผั ะฟะพะปั

**ะัะธะฒัะทะบะฐ ะดะฐะฝะฝัั:**
```svelte
<select bind:value={settings.ollama_model}>
  {#each availableModels as model}
    <option value={model}>{model}</option>
  {/each}
</select>
```

---

#### ๐ง ะกะตะบัะธั 2: CORTEX (RAG Knowledge Base)

**ะญะปะตะผะตะฝัั:**
- `<input type="number">` ะดะปั `top_k` (ะดะธะฐะฟะฐะทะพะฝ 5-50, default 20)
- `<select>` ะดะปั ัะตะถะธะผะฐ ะฟะพะธัะบะฐ:
  - `local` โ ะปะพะบะฐะปัะฝัะน ะบะพะฝัะตะบัั (ะฑััััะตะต)
  - `hybrid` โ ะณะธะฑัะธะดะฝัะน ะฟะพะธัะบ (ัะพัะฝะตะต)

**ะัะธะฒัะทะบะฐ ะดะฐะฝะฝัั:**
```svelte
<input id="cortex-top-k" type="number" min="5" max="50" 
       bind:value={settings.cortex_top_k} />

<select id="cortex-mode" bind:value={settings.cortex_mode}>
  <option value="local">Local (ะปะพะบะฐะปัะฝัะน ะบะพะฝัะตะบัั)</option>
  <option value="hybrid">Hybrid (ะณะธะฑัะธะดะฝัะน ะฟะพะธัะบ)</option>
</select>
```

---

#### ๐ค ะกะตะบัะธั 3: ะัะพัะธะปะธ ะฐะณะตะฝัะฐ

**ะะพัััะฟะฝัะต ะฟัะพัะธะปะธ:**

| ID | ะะฐะทะฒะฐะฝะธะต | ะะฟะธัะฐะฝะธะต |
|---|---|---|
| `triz_engineer` | ๐ง ะขะะะ-ะธะฝะถะตะฝะตั | ะะตัะตะฝะธะต ะธะทะพะฑัะตัะฐัะตะปััะบะธั ะทะฐะดะฐั |
| `doc_organizer` | ๐ ะะพะบัะผะตะฝัะฐะปะธัั | ะัะณะฐะฝะธะทะฐัะธั ะทะฝะฐะฝะธะน |
| `code_assistant` | ๐ป Code Assistant | ะะพะผะพัั ะฒ ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธะธ |

**UI ัะตะฐะปะธะทะฐัะธั:**
```svelte
<div class="profiles-grid">
  {#each agentProfiles as profile}
    <button 
      class="profile-card"
      class:active={settings.active_agent_profile === profile.id}
      on:click={() => settings.active_agent_profile = profile.id}
    >
      <div class="profile-name">{profile.name}</div>
      <div class="profile-description">{profile.description}</div>
      {#if settings.active_agent_profile === profile.id}
        <div class="profile-badge">โ ะะบัะธะฒะตะฝ</div>
      {/if}
    </button>
  {/each}
</div>
```

**ะะธะทัะฐะปัะฝัะต ัััะตะบัั:**
- ะะบัะธะฒะฝะฐั ะบะฐััะพัะบะฐ ะฟะพะดัะฒะตัะธะฒะฐะตััั ะทะตะปัะฝัะผ ัะฒะตัะพะผ (`border-color: #27ae60`)
- ะะฝะฐัะพะบ "โ ะะบัะธะฒะตะฝ" ะฒ ะฟัะฐะฒะพะผ ะฒะตััะฝะตะผ ัะณะปั
- Hover ัััะตะบั: ะฟะพะดะฝััะธะต ะบะฐััะพัะบะธ ะฝะฐ 2px

---

#### ๐พ ะะฝะพะฟะบะฐ ัะพััะฐะฝะตะฝะธั ะธ ะพะฑัะฐะฑะพัะบะฐ ัะพััะพัะฝะธะน

**ะคัะฝะบัะธั ัะพััะฐะฝะตะฝะธั:**
```typescript
async function saveSettings() {
  isSaving = true;
  saveMessage = "";
  errorMessage = "";

  try {
    const response = await invoke<ApiResponse<AppSettings>>(
      "save_app_settings",
      { settings }
    );

    if (response.ok) {
      saveMessage = "โ ะะฐัััะพะนะบะธ ัะพััะฐะฝะตะฝั ััะฟะตัะฝะพ!";
      setTimeout(() => { saveMessage = ""; }, 3000);
    } else {
      errorMessage = response.error?.message || "ะะต ัะดะฐะปะพัั ัะพััะฐะฝะธัั ะฝะฐัััะพะนะบะธ";
    }
  } catch (err) {
    errorMessage = `ะัะธะฑะบะฐ ัะพััะฐะฝะตะฝะธั: ${err}`;
  } finally {
    isSaving = false;
  }
}
```

**ะกะพััะพัะฝะธั UI:**
- `isLoading` โ ะฟะพะบะฐะทัะฒะฐะตั ัะฟะธะฝะฝะตั ะฟัะธ ะทะฐะณััะทะบะต ะฝะฐัััะพะตะบ
- `isSaving` โ ะฑะปะพะบะธััะตั ะบะฝะพะฟะบั ัะพััะฐะฝะตะฝะธั, ะฟะพะบะฐะทัะฒะฐะตั "ะกะพััะฐะฝะตะฝะธะต..."
- `saveMessage` โ ะทะตะปัะฝะพะต ัะพะพะฑัะตะฝะธะต ััะฟะตัะฐ (ะฐะฒัะพัะบัััะธะต ัะตัะตะท 3ั)
- `errorMessage` โ ะบัะฐัะฝะพะต ัะพะพะฑัะตะฝะธะต ะพะฑ ะพัะธะฑะบะต

---

#### ๐จ ะกัะธะปะธะทะฐัะธั

**ะฆะฒะตัะพะฒะฐั ััะตะผะฐ:**
- ะัะฝะพะฒะฝะพะน ัะพะฝ: `#f8f9fa` (ัะฒะตัะปะพ-ัะตััะน)
- ะะบัะตะฝัะฝัะน ัะฒะตั: `#3498db` (ัะธะฝะธะน) ะดะปั ะทะฐะณะพะปะพะฒะบะพะฒ ะธ ะบะฝะพะฟะพะบ
- ะฃัะฟะตั: `#27ae60` (ะทะตะปัะฝัะน) ะดะปั ะฐะบัะธะฒะฝัั ัะปะตะผะตะฝัะพะฒ
- ะัะธะฑะบะฐ: `#f8d7da` (ัะฒะตัะปะพ-ะบัะฐัะฝัะน) ะดะปั ัะพะพะฑัะตะฝะธะน ะพะฑ ะพัะธะฑะบะฐั

**ะะดะฐะฟัะธะฒะฝะพััั:**
- ะัะพัะธะปะธ ะฒ grid ั `minmax(250px, 1fr)` โ ะฐะฒัะพะฟะพะดัััะพะนะบะฐ ะฟะพะด ัะธัะธะฝั
- ะะฐะบัะธะผะฐะปัะฝะฐั ัะธัะธะฝะฐ ะฟะฐะฝะตะปะธ: 900px, ัะตะฝััะธัะพะฒะฐะฝะธะต
- ะะปะฐะฒะฝัะต transitions ะฝะฐ ะฒัะตั ะธะฝัะตัะฐะบัะธะฒะฝัั ัะปะตะผะตะฝัะฐั

---

### Task 5.1: ะะบะปะฐะดะบะฐ Settings ะฒ ะฝะฐะฒะธะณะฐัะธะธ โ

**ะคะฐะนะป:** `client/src/routes/+page.svelte`

**ะะทะผะตะฝะตะฝะธั:**

1. **ะะผะฟะพัั SettingsPanel:**
```svelte
import SettingsPanel from '$lib/components/SettingsPanel.svelte';
```

2. **ะะฐััะธัะตะฝะธะต ัะธะฟะฐ View:**
```typescript
type View = 'chat' | 'status' | 'settings';
```

3. **ะะพะฑะฐะฒะปะตะฝะธะต ะบะฝะพะฟะบะธ ะฒ ะฝะฐะฒะธะณะฐัะธั:**
```svelte
<button 
  class:selected={activeView === 'settings'} 
  on:click={() => activeView = 'settings'}
>
  โ๏ธ Settings
</button>
```

4. **ะะตะฝะดะตัะธะฝะณ ะบะพะผะฟะพะฝะตะฝัะฐ:**
```svelte
{:else if activeView === 'settings'}
  <SettingsPanel />
{/if}
```

**ะะตะทัะปััะฐั:**
- 3 ะฒะบะปะฐะดะบะธ ะฒ ะฝะฐะฒะธะณะฐัะธะธ: ๐ฌ Chat | ๐ก System Status | โ๏ธ Settings
- ะะฐะฒะฝะพะผะตัะฝะพะต ัะฐัะฟัะตะดะตะปะตะฝะธะต (`flex: 1`)
- ะะพะดัะฒะตัะบะฐ ะฐะบัะธะฒะฝะพะน ะฒะบะปะฐะดะบะธ ะทะตะปัะฝัะผ ัะฒะตัะพะผ (`border-bottom: 3px solid #4CAF50`)

---

### Task 5.6: ะะฝัะตะณัะฐัะธั ChatPanel ั ะฝะฐัััะพะนะบะฐะผะธ โ

**ะคะฐะนะป:** `client/src/lib/components/ChatPanel.svelte`

**ะะทะผะตะฝะตะฝะธั:**

1. **ะะพะฑะฐะฒะปะตะฝะธะต ะธะฝัะตััะตะนัะฐ AppSettings:**
```typescript
interface AppSettings {
  ollama_model: string;
  max_tokens: number | null;
  cortex_top_k: number;
  cortex_mode: string;
  active_agent_profile: string;
}

let appSettings: AppSettings | null = null;
```

2. **ะะฐะณััะทะบะฐ ะฝะฐัััะพะตะบ ะฟัะธ ะผะพะฝัะธัะพะฒะฐะฝะธะธ:**
```typescript
import { onMount } from 'svelte';

onMount(async () => {
  try {
    const response = await invoke<ApiResponse<AppSettings>>('get_app_settings');
    if (response.ok && response.data) {
      appSettings = response.data;
      console.log('โ ะะฐัััะพะนะบะธ ะทะฐะณััะถะตะฝั ะฒ ChatPanel:', appSettings);
    }
  } catch (err) {
    console.error('โ ะัะธะฑะบะฐ ะทะฐะณััะทะบะธ ะฝะฐัััะพะตะบ:', err);
  }
});
```

3. **ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฝะฐัััะพะตะบ ะฒ ะทะฐะฟัะพัะต ะบ Ollama:**
```typescript
const response = await invoke<ApiResponse<OllamaResponse>>('send_ollama_chat', {
  prompt: userText,
  model: appSettings?.ollama_model || null,  // ะะท ะฝะฐัััะพะตะบ
});
```

4. **ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฝะฐัััะพะตะบ ะฒ ะทะฐะฟัะพัะต ะบ CORTEX:**
```typescript
const response = await invoke<ApiResponse<CortexResponse>>('send_cortex_query', {
  query: userText,
  topK: appSettings?.cortex_top_k || null,   // ะะท ะฝะฐัััะพะตะบ
  mode: appSettings?.cortex_mode || null,    // ะะท ะฝะฐัััะพะตะบ
});
```

**ะะพะณะธะบะฐ ัะฐะฑะพัั:**
- ะะฐัััะพะนะบะธ ะทะฐะณััะถะฐัััั **ะพะดะธะฝ ัะฐะท** ะฟัะธ ะพัะบัััะธะธ Chat
- ะัะปะธ `appSettings === null` โ ะบะพะผะฐะฝะดั ะธัะฟะพะปัะทััั ัะฒะพะธ fallback ะทะฝะฐัะตะฝะธั
- ะัะปะธ ะฝะฐัััะพะนะบะธ ะทะฐะณััะถะตะฝั โ ะพะฝะธ ะฟะตัะตะดะฐัััั ะฒ Tauri ะบะพะผะฐะฝะดั
- Tauri ะบะพะผะฐะฝะดั ะธะผะตัั ะฟัะธะพัะธัะตัะฝัั ะปะพะณะธะบั: `ะฟะฐัะฐะผะตัั ะธะท UI -> ะฝะฐัััะพะนะบะธ -> default`

---

## ๐งช Task 5.7: ะขะตััะธัะพะฒะฐะฝะธะต

**ะกะพะทะดะฐะฝ ัะตััะพะฒัะน ัะบัะธะฟั:** `client/test_task5_settings.ps1`

**ะะตะทัะปััะฐัั ะฟัะตะดะฒะฐัะธัะตะปัะฝะพะน ะฟัะพะฒะตัะบะธ:**

### โ ะัะพะฒะตัะบะฐ ัะตัะฒะธัะพะฒ:
- **Ollama (localhost:11434):** โ ะะฐะฑะพัะฐะตั
  - ะะพัััะฟะฝัะต ะผะพะดะตะปะธ: triz-td010v2:latest, qwen2.5:3b-instruct, qwen2.5:14b, llama3.1:8b, librarian-lite:latest
- **CORTEX (localhost:8004):** โ ะะฐะฑะพัะฐะตั
  - ะกัะฐััั: healthy

### โ ะัะพะฒะตัะบะฐ ัะฐะนะปะฐ ะฝะฐัััะพะตะบ:
- ะััั: `C:\Users\zakon\AppData\Roaming\tauri_fresh\settings.json`
- ะกัะฐััั: ะัะดะตั ัะพะทะดะฐะฝ ะฟัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต (ะพะถะธะดะฐะตะผะพะต ะฟะพะฒะตะดะตะฝะธะต)

### ๐งช ะะฐะฟะปะฐะฝะธัะพะฒะฐะฝะฝัะต ัะตััะพะฒัะต ััะตะฝะฐัะธะธ:

1. **ะขะตัั ะฝะฐะฒะธะณะฐัะธะธ:**
   - ะัะบัััะธะต ะฒะบะปะฐะดะบะธ โ๏ธ Settings
   - ะัะพะฒะตัะบะฐ ะทะฐะณััะทะบะธ ะฒัะตั 3 ัะตะบัะธะน

2. **ะขะตัั ัะผะตะฝั ะผะพะดะตะปะธ:**
   - ะะทะผะตะฝะตะฝะธะต ะผะพะดะตะปะธ ะฒ Settings
   - ะกะพััะฐะฝะตะฝะธะต
   - ะัะพะฒะตัะบะฐ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฝะพะฒะพะน ะผะพะดะตะปะธ ะฒ Chat (Ollama)

3. **ะขะตัั CORTEX ะฟะฐัะฐะผะตััะพะฒ:**
   - ะะทะผะตะฝะตะฝะธะต `top_k` (20 โ 10)
   - ะะทะผะตะฝะตะฝะธะต `mode` (local โ hybrid)
   - ะัะพะฒะตัะบะฐ ะฟัะธะผะตะฝะตะฝะธั ะฒ ะทะฐะฟัะพัะฐั ะบ CORTEX

4. **ะขะตัั ะฟัะพัะธะปะตะน ะฐะณะตะฝัะฐ:**
   - ะะตัะตะบะปััะตะฝะธะต ะผะตะถะดั ะฟัะพัะธะปัะผะธ
   - ะัะพะฒะตัะบะฐ ัะพััะฐะฝะตะฝะธั ะฒ `settings.json`

5. **ะขะตัั ะฟะตััะธััะตะฝัะฝะพััะธ:**
   - ะะทะผะตะฝะตะฝะธะต ะฝะฐัััะพะตะบ
   - ะะตัะตะทะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั
   - ะัะพะฒะตัะบะฐ ะฒะพัััะฐะฝะพะฒะปะตะฝะธั ะทะฝะฐัะตะฝะธะน

### โ ะัะธัะตัะธะธ ััะฟะตัะฝะพะณะพ ะฟัะพัะพะถะดะตะฝะธั:

- [x] ะะพะด ััะฟะตัะฝะพ ัะบะพะผะฟะธะปะธัะพะฒะฐะฝ (`cargo check` โ)
- [x] ะะบะปะฐะดะบะฐ Settings ะดะพะฑะฐะฒะปะตะฝะฐ ะฒ ะฝะฐะฒะธะณะฐัะธั
- [x] SettingsPanel ะบะพะผะฟะพะฝะตะฝั ัะพะทะดะฐะฝ (380+ ัััะพะบ)
- [x] ChatPanel ะธะฝัะตะณัะธัะพะฒะฐะฝ ั ะฝะฐัััะพะนะบะฐะผะธ
- [x] Tauri ะบะพะผะฐะฝะดั `get_app_settings` ะธ `save_app_settings` ะทะฐัะตะณะธัััะธัะพะฒะฐะฝั
- [x] Core Bridge ะบะพะผะฐะฝะดั ะธัะฟะพะปัะทััั ะฝะฐัััะพะนะบะธ
- [ ] UI ัะตััะธัะพะฒะฐะฝะธะต (ััะตะฑัะตััั ะทะฐะฟััะบ `npm run tauri dev`)

---

## ๐ ะกัะฐัะธััะธะบะฐ ะบะพะดะฐ

### ะะพะฒัะต ัะฐะนะปั:

| ะคะฐะนะป | ะกััะพะบ | ะะฐะทะฝะฐัะตะฝะธะต |
|------|-------|------------|
| `src-tauri/src/settings.rs` | 95 | Rust backend ะดะปั ะฝะฐัััะพะตะบ |
| `src/lib/components/SettingsPanel.svelte` | 380+ | UI ะบะพะผะฟะพะฝะตะฝัะฐ ะฝะฐัััะพะตะบ |
| `test_task5_settings.ps1` | 150+ | ะขะตััะพะฒัะน ัะบัะธะฟั |

### ะะพะดะธัะธัะธัะพะฒะฐะฝะฝัะต ัะฐะนะปั:

| ะคะฐะนะป | ะะทะผะตะฝะตะฝะธั | ะะฟะธัะฐะฝะธะต |
|------|-----------|----------|
| `src-tauri/Cargo.toml` | +1 ัััะพะบะฐ | ะะฐะฒะธัะธะผะพััั `dirs = "5.0"` |
| `src-tauri/src/lib.rs` | +5 ัััะพะบ | ะะตะณะธัััะฐัะธั ะผะพะดัะปั ะธ ะบะพะผะฐะฝะด |
| `src-tauri/src/commands.rs` | +25 ัััะพะบ | ะะพะฒัะต ะบะพะผะฐะฝะดั + ะธะฝัะตะณัะฐัะธั ะฝะฐัััะพะตะบ |
| `src/routes/+page.svelte` | +10 ัััะพะบ | ะะฐะฒะธะณะฐัะธั Settings |
| `src/lib/components/ChatPanel.svelte` | +30 ัััะพะบ | ะะฐะณััะทะบะฐ ะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะฝะฐัััะพะตะบ |

**ะะฑัะธะน ะพะฑััะผ ะธะทะผะตะฝะตะฝะธะน:** ~700 ัััะพะบ ะบะพะดะฐ (ะฝะพะฒัะน + ะผะพะดะธัะธัะธัะพะฒะฐะฝะฝัะน)

---

## ๐ง ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### ะััะธัะตะบัััะฐ ะฝะฐัััะพะตะบ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Frontend (Svelte)                                      โ
โ  โโโโโโโโโโโโโโโโโโโ         โโโโโโโโโโโโโโโโโโโ      โ
โ  โ SettingsPanel   โ         โ   ChatPanel     โ      โ
โ  โ                 โ         โ                 โ      โ
โ  โ โข UI ัะพัะผั      โ         โ โข onMount:      โ      โ
โ  โ โข ะกะพััะฐะฝะตะฝะธะต    โ         โ   load settings โ      โ
โ  โ โข ะะฐะปะธะดะฐัะธั     โ         โ โข ะัะฟะพะปัะทะพะฒะฐะฝะธะต โ      โ
โ  โโโโโโโโโโฌโโโโโโโโโ         โโโโโโโโโโฌโโโโโโโโโ      โ
โ           โ                           โ                โ
โ           โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                โ
โ           โ invoke('get_app_settings')                 โ
โ           โ invoke('save_app_settings')                โ
โโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
            โ Tauri IPC
            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Backend (Rust)                                       โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ settings.rs                                     โ โ
โ  โ  โข load_settings() โ AppSettings                โ โ
โ  โ  โข save_settings(&AppSettings) โ Result<()>     โ โ
โ  โ  โข get_settings_path() โ PathBuf                โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                         โ                             โ
โ                         โผ                             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ commands.rs                                     โ โ
โ  โ  โข get_app_settings() โ ApiResponse             โ โ
โ  โ  โข save_app_settings() โ ApiResponse            โ โ
โ  โ  โข send_ollama_chat() โ uses settings.model    โ โ
โ  โ  โข send_cortex_query() โ uses settings.params  โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  File System                                          โ
โ  %APPDATA%\tauri_fresh\settings.json                  โ
โ  {                                                    โ
โ    "ollama_model": "qwen2.5:14b-instruct-q4_k_m",    โ
โ    "max_tokens": null,                               โ
โ    "cortex_top_k": 20,                               โ
โ    "cortex_mode": "local",                           โ
โ    "active_agent_profile": "triz_engineer"           โ
โ  }                                                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะะพัะพะบ ะดะฐะฝะฝัั:

1. **ะะตัะฒัะน ะทะฐะฟััะบ:**
   - `load_settings()` โ ัะฐะนะป ะฝะต ะฝะฐะนะดะตะฝ โ ะฒะพะทะฒัะฐั `Default::default()`
   - UI ะพัะพะฑัะฐะถะฐะตั default ะทะฝะฐัะตะฝะธั

2. **ะะพะปัะทะพะฒะฐัะตะปั ะผะตะฝัะตั ะฝะฐัััะพะนะบะธ:**
   - UI ะฑะธะฝะดะธะฝะณ ะพะฑะฝะพะฒะปัะตั ะปะพะบะฐะปัะฝะพะต ัะพััะพัะฝะธะต `settings`
   - ะะปะธะบ "ะกะพััะฐะฝะธัั" โ `invoke('save_app_settings', {settings})`
   - Rust: `save_settings()` โ ะทะฐะฟะธัั JSON ะฒ ัะฐะนะป
   - UI: ะฟะพะบะฐะท success ัะพะพะฑัะตะฝะธั

3. **ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ Chat:**
   - `ChatPanel.onMount()` โ `invoke('get_app_settings')`
   - Rust: `load_settings()` โ ััะตะฝะธะต ะธะท ัะฐะนะปะฐ
   - Frontend: ัะพััะฐะฝะตะฝะธะต ะฒ `appSettings`
   - ะัะธ ะพัะฟัะฐะฒะบะต ัะพะพะฑัะตะฝะธั: `invoke('send_ollama_chat', {model: appSettings.ollama_model})`

4. **ะะตัะตะทะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั:**
   - `load_settings()` โ ััะตะฝะธะต ัะพััะฐะฝัะฝะฝะพะณะพ ัะฐะนะปะฐ
   - UI ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะตั ะฟะพัะปะตะดะฝะธะต ะทะฝะฐัะตะฝะธั

---

## ๐จ UI/UX ะพัะพะฑะตะฝะฝะพััะธ

### ะะธะทัะฐะปัะฝัะต ัััะตะบัั:
- **Spinner ะฟัะธ ะทะฐะณััะทะบะต:** ะัััััะธะนัั ะธะฝะดะธะบะฐัะพั ะฒะพ ะฒัะตะผั `isLoading`
- **Disabled ะบะฝะพะฟะบะฐ:** ะกะตัะฐั ะบะฝะพะฟะบะฐ ั `cursor: not-allowed` ะฟัะธ `isSaving`
- **Success toast:** ะะตะปัะฝะพะต ัะพะพะฑัะตะฝะธะต ั ะฐะฒัะพัะบัััะธะตะผ ัะตัะตะท 3 ัะตะบัะฝะดั
- **Error toast:** ะัะฐัะฝะพะต ัะพะพะฑัะตะฝะธะต ั ะฟะพะดัะพะฑะฝัะผ ะพะฟะธัะฐะฝะธะตะผ ะพัะธะฑะบะธ
- **Hover ัััะตะบัั:** ะัะต ะธะฝัะตัะฐะบัะธะฒะฝัะต ัะปะตะผะตะฝัั ะฟะพะดะฝะธะผะฐัััั ะฝะฐ 2px ะฟัะธ ะฝะฐะฒะตะดะตะฝะธะธ
- **ะะบัะธะฒะฝัะน ะฟัะพัะธะปั:** ะะตะปัะฝะฐั ัะฐะผะบะฐ + ะทะฝะฐัะพะบ "โ ะะบัะธะฒะตะฝ"

### ะะดะฐะฟัะธะฒะฝะพััั:
- Grid ะฟัะพัะธะปะตะน ะฟะพะดัััะฐะธะฒะฐะตััั ะฟะพะด ัะธัะธะฝั ัะบัะฐะฝะฐ
- ะะฐะบัะธะผะฐะปัะฝะฐั ัะธัะธะฝะฐ 900px ะดะปั ะบะพะผัะพััะฝะพะณะพ ััะตะฝะธั
- ะะตััะธะบะฐะปัะฝัะน scrolling ะดะปั ะดะปะธะฝะฝัั ัะพัะผ

### ะะพัััะฟะฝะพััั:
- ะัะต inputs ะธะผะตัั ัะฒัะทะฐะฝะฝัะต `<label>` ั `for` ะฐััะธะฑััะฐะผะธ
- ะะพะดัะบะฐะทะบะธ (hints) ะฟะพะด ะบะฐะถะดัะผ ะฟะพะปะตะผ
- ะงััะบะธะต ัะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั
- ะะพะณะธัะพะฒะฐะฝะธะต ะฒ ะบะพะฝัะพะปั ะดะปั ะพัะปะฐะดะบะธ

---

## ๐ ะะพัะพะฒะฝะพััั ะบ ัะตััะธัะพะฒะฐะฝะธั

### ะัะตะดะฒะฐัะธัะตะปัะฝัะต ะฟัะพะฒะตัะบะธ ะฟัะพะนะดะตะฝั:
- โ `cargo check` โ ััะฟะตัะฝะพ
- โ Ollama ัะฐะฑะพัะฐะตั (5 ะผะพะดะตะปะตะน ะดะพัััะฟะฝะพ)
- โ CORTEX ัะฐะฑะพัะฐะตั (status: healthy)
- โ ะัะต ัะฐะนะปั ัะพะทะดะฐะฝั
- โ ะัะต ะธะฝัะตะณัะฐัะธะธ ะฒัะฟะพะปะฝะตะฝั

### ะกะปะตะดัััะธะต ัะฐะณะธ:
1. ะะฐะฟัััะธัั `npm run tauri dev`
2. ะัะพะนัะธ ะฒัะต 5 ัะตััะพะฒัั ััะตะฝะฐัะธะตะฒ
3. ะัะพะฒะตัะธัั 12 ะบัะธัะตัะธะตะฒ ััะฟะตัะฝะพััะธ
4. ะกะพะฑัะฐัั ัะบัะธะฝัะพัั ะธ ะปะพะณะธ
5. ะกะพะทะดะฐัั ัะธะฝะฐะปัะฝัะน ะพัััั ั ัะตะทัะปััะฐัะฐะผะธ ัะตััะธัะพะฒะฐะฝะธั

---

## ๐ ะะปั ัะธะฝะฐะปัะฝะพะณะพ ะพััััะฐ ะฟะพััะตะฑัะตััั:

- [ ] ะกะบัะธะฝัะพั ะฒะบะปะฐะดะบะธ โ๏ธ Settings (ะฒัะต 3 ัะตะบัะธะธ)
- [ ] ะกะบัะธะฝัะพั ััะฟะตัะฝะพะณะพ ัะพััะฐะฝะตะฝะธั ะฝะฐัััะพะตะบ
- [ ] ะกะพะดะตัะถะธะผะพะต `settings.json` ะฟะพัะปะต ะธะทะผะตะฝะตะฝะธะน
- [ ] ะะพะณะธ ะธะท ะบะพะฝัะพะปะธ ะฑัะฐัะทะตัะฐ (F12) ั `console.log` ัะพะพะฑัะตะฝะธัะผะธ
- [ ] ะกะบัะธะฝัะพั Chat ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะฝะพะฒะพะน ะผะพะดะตะปะธ
- [ ] ะกะบัะธะฝัะพั CORTEX ะทะฐะฟัะพัะฐ ั ะธะทะผะตะฝัะฝะฝัะผะธ ะฟะฐัะฐะผะตััะฐะผะธ
- [ ] ะะพะดัะฒะตัะถะดะตะฝะธะต ะฟะตััะธััะตะฝัะฝะพััะธ ะฟะพัะปะต ะฟะตัะตะทะฐะฟััะบะฐ

---

## ๐ฏ ะัะพะณะธ Task 5

**ะะพััะธะณะฝััะพ:**
- โ ะะพะปะฝะพัััั ัะฐะฑะพัะธะน backend ะดะปั ะฝะฐัััะพะตะบ (Rust)
- โ ะะพะปะฝะพััะฝะบัะธะพะฝะฐะปัะฝัะน UI ะบะพะผะฟะพะฝะตะฝั (Svelte)
- โ ะะฝัะตะณัะฐัะธั ั Core Bridge ะบะพะผะฐะฝะดะฐะผะธ
- โ ะัะพัั-ะฟะปะฐััะพัะผะตะฝะฝะฐั ะฟะตััะธััะตะฝัะฝะพััั
- โ 3 ะฟัะพัะธะปั ะฐะณะตะฝัะฐ ั ะฒะธะทัะฐะปัะฝัะผ ะฟะตัะตะบะปััะตะฝะธะตะผ
- โ Graceful error handling ะฝะฐ ะฒัะตั ััะพะฒะฝัั
- โ ะะพะดัะพะฑะฝัะน ัะตััะพะฒัะน ัะบัะธะฟั
- โ ะะพะบัะผะตะฝัะฐัะธั ะธ ะพัััั

**ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั:** ~2 ัะฐัะฐ (ะฟะพ ะฟะปะฐะฝั)

**ะะพะด ััะธะปั:** ะกะพะพัะฒะตัััะฒัะตั ะฟัะพะตะบัั, ัะธัััะน, ะดะพะบัะผะตะฝัะธัะพะฒะฐะฝะฝัะน

**ะกัะฐััั:** โ **READY FOR USER ACCEPTANCE TESTING**

---

**ะะฐัะฐ ะทะฐะฒะตััะตะฝะธั:** 27 ะฝะพัะฑัั 2025 ะณ., 20:45 MSK  
**ะะฐะทัะฐะฑะพััะธะบ:** AI Agent (Claude Sonnet 4.5)  
**ะะตะฒะธะทะพั:** Zasada1980 (pending UAT)
